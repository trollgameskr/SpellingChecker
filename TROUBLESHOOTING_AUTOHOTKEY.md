# AutoHotkey 버전 문제 해결 가이드

## UI가 실행되지 않는 경우

### 1. 텍스트가 선택되지 않은 경우
**증상**: 단축키를 눌러도 아무 반응이 없음

**해결 방법**:
1. 메모장이나 워드 등에서 텍스트를 **먼저 선택**하세요
2. 선택된 상태에서 단축키를 누르세요
3. 이제 팝업창이 나타납니다

**확인**: 텍스트를 선택하지 않으면 "텍스트를 선택하지 않았습니다" 메시지박스가 나타납니다.

### 2. API 키가 설정되지 않은 경우
**증상**: 단축키를 눌렀을 때 "API 키가 설정되지 않았습니다" 메시지 표시

**해결 방법**:
1. 시스템 트레이에서 SpellingChecker 아이콘 우클릭
2. "Settings" 메뉴 클릭
3. "API Key" 필드에 OpenAI API 키 입력
4. "Save" 버튼 클릭
5. 다시 단축키 시도

### 3. 인터넷 연결 문제
**증상**: "API 요청 중 오류 발생" 메시지 표시

**해결 방법**:
1. 인터넷 연결 확인
2. 방화벽 설정 확인 (AutoHotkey가 차단되어 있는지)
3. 프록시 사용 중이라면 프록시 설정 확인

### 4. AutoHotkey v2.0이 설치되지 않은 경우
**증상**: 스크립트 실행 시 오류 메시지

**해결 방법**:
1. https://www.autohotkey.com/ 접속
2. **AutoHotkey v2.0** 다운로드 (v1.1이 아님!)
3. 설치 후 스크립트 재실행

## 단계별 테스트

### 테스트 1: 스크립트 실행 확인
```
1. SpellingChecker.ahk 더블클릭
2. 시스템 트레이에 AutoHotkey 아이콘 확인
3. 아이콘이 보이면 ✅ 정상
```

### 테스트 2: 설정 창 확인
```
1. 트레이 아이콘 우클릭
2. "Settings" 메뉴 클릭
3. 설정 창이 열리면 ✅ 정상
```

### 테스트 3: API 키 설정
```
1. Settings 창에서 API Key 입력
2. Save 클릭
3. "Settings Saved" 알림이 뜨면 ✅ 정상
```

### 테스트 4: 텍스트 선택 및 단축키
```
1. 메모장 열기
2. "안녕하세요" 입력
3. 텍스트 선택 (마우스로 드래그)
4. Ctrl+Shift+Alt+Y 누르기
5. 팝업 창이 열리면 ✅ 정상
```

## 자주 발생하는 오류 메시지

### "텍스트를 선택하지 않았습니다"
- **원인**: 텍스트를 선택하지 않고 단축키를 누름
- **해결**: 텍스트를 먼저 선택한 후 단축키 누르기

### "API 키가 설정되지 않았습니다"
- **원인**: Settings에 API 키가 입력되지 않음
- **해결**: Settings에서 OpenAI API 키 입력 후 저장

### "API 요청 실패 - 상태 코드: 401"
- **원인**: API 키가 올바르지 않음
- **해결**: Settings에서 API 키 재확인 및 재입력

### "API 요청 실패 - 상태 코드: 429"
- **원인**: API 사용량 한도 초과
- **해결**: 잠시 후 재시도 또는 OpenAI 계정에서 한도 확인

### "API 요청 중 오류 발생"
- **원인**: 인터넷 연결 문제 또는 방화벽 차단
- **해결**: 
  1. 인터넷 연결 확인
  2. 방화벽에서 AutoHotkey 허용
  3. 프록시 설정 확인

## 개선된 기능 (최신 버전)

### 향상된 에러 메시지
- 이제 모든 오류 메시지가 한글로 표시됩니다
- 상세한 오류 원인과 해결 방법 제공
- API 상태 코드에 따른 구체적인 안내

### 긴 대기 시간
- 클립보드 대기 시간 증가 (0.5초 → 1초)
- 느린 애플리케이션에서도 안정적으로 작동

### Try-Catch 오류 처리
- 모든 핵심 함수에 예외 처리 추가
- 예상치 못한 오류도 친절한 메시지로 안내

## 디버깅 팁

### 로그 확인
사용 기록은 다음 위치에 저장됩니다:
```
%APPDATA%\SpellingChecker\usage.json
```

### 설정 확인
설정 파일 위치:
```
%APPDATA%\SpellingChecker\settings.ini
```

파일을 메모장으로 열어 API 키가 제대로 저장되었는지 확인 가능

### 스크립트 재시작
문제가 계속되면:
1. 시스템 트레이에서 아이콘 우클릭 → Exit
2. SpellingChecker.ahk 다시 실행

## 추가 도움

더 많은 정보는 다음 문서를 참조하세요:
- [README_AUTOHOTKEY.md](README_AUTOHOTKEY.md) - 전체 사용 설명서
- [QUICKSTART_AUTOHOTKEY.md](QUICKSTART_AUTOHOTKEY.md) - 빠른 시작 가이드
- [VERSION_COMPARISON.md](VERSION_COMPARISON.md) - C# 버전과 비교

GitHub Issues에 문제를 보고할 때는 다음 정보를 포함해주세요:
- Windows 버전
- AutoHotkey 버전 (v2.0.x)
- 발생한 오류 메시지
- 어떤 작업 중 오류가 발생했는지
